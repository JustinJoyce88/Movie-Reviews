var Movie=require("../models/movie"),Comment=require("../models/comment"),middlewareObj={movieOwnership:function(e,r,i){e.isAuthenticated()?Movie.findById(e.params.id,function(o,d){o||!d?(e.flash("error","Movie not found."),r.redirect("back")):d.author.id.equals(e.user._id)||e.user.isAdmin?i():(e.flash("error","Permission denied."),r.redirect("back"))}):(e.flash("error","You must be logged in."),r.redirect("back"))},commentOwnership:function(e,r,i){e.isAuthenticated()?Comment.findById(e.params.comment_id,function(o,d){o||!d?(e.flash("error","Comment not found."),r.redirect("back")):d.author.id.equals(e.user._id)||e.user.isAdmin?i():(e.flash("error","Permission denied."),r.redirect("back"))}):(e.flash("error","You must be logged in."),r.redirect("back"))},isLoggedIn:function(e,r,i){if(e.isAuthenticated())return i();e.flash("error","You must be logged in."),r.redirect("/login")}};module.exports=middlewareObj;